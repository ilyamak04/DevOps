### –Ω–∞ –±–∞–∑–µ Red Hat

- `firewall-cmd --zone=public --add-masquerade --permanent`
- `firewall-cmd --reload`

### –ù–∞ –±–∞–∑–µ Debian
#### firewall Ubuntu - ufw

```
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ UFW
sudo apt update
sudo apt install ufw

# –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è SSH (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
sudo ufw allow <ssh-port>/tcp

# –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ
sudo ufw default deny incoming
sudo ufw default allow outgoing

# –í–∫–ª—é—á–∞–µ–º —Ñ–∞–µ—Ä–≤–æ–ª–ª
sudo ufw enable
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
ufw reload

# –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ ufw –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
sudo ufw status verbose
ufw status numbered
```
```
# –û—Ç–∫–ª—é—á–∏—Ç—å —Ñ–∞–µ—Ä–≤–æ–ª–ª
sudo ufw disable

# –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ (–±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
sudo ufw delete allow <port>/<protocol> # —É–¥–∞–ª–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
sudo ufw delete deny <port>/<protocol> # —É–¥–∞–ª–∏—Ç—å –∑–∞–ø—Ä–µ—Ç

# –°–±—Ä–æ—Å –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª
sudo ufw reset

# –í—ã–≤–µ—Å—Ç–∏ –ª–æ–≥–∏ ufw
sudo tail -f -n 100 /var/log/ufw.log

# –ò–∑–º–µ–Ω–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
sudo ufw logging <low/medium/high>

# –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º –ø–æ—Ä—Ç–∞–º —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞
sudo ufw allow from <IPv4>

# –†–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç—É —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ IP-–∞–¥—Ä–µ—Å–∞
sudo ufw allow from <IPv4> to any port <port>
```
```
# –ü—Ä–µ—Å–µ—Ç—ã
# –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ—Å–µ—Ç–æ–≤
sudo ufw app list

# –û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã Nginx
sudo ufw allow "Nginx Full"

# –£–¥–∞–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –ø—Ä–µ—Å–µ—Ç–∞
sudo ufw delete allow "Nginx Full"
```
```
# –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
sudo ufw allow in on wg0
sudo ufw allow out on wg0
```


–î–∞, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á—ë—Ç–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω–æ–º –≤–∏–¥–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±–∏—Ç–∞–º–∏ –∏ –±–∞–π—Ç–∞–º–∏.
–ù–æ —Ä–∞–∑–Ω–∏—Ü–∞ –≤ —Ç–æ–º, –∫–∞–∫ –∏ –≥–¥–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —ç—Ç–∞ "–±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è" –¥–∞–Ω–Ω—ã—Ö.

‚ö° HTTP/1.1: –¢–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –±–∏–Ω–∞—Ä–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π –Ω–∞ —Å–µ—Ç–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ
–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π —Ç–µ–∫—Å—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–≥–æ–ª–æ–≤–∫–∏ GET / HTTP/1.1 –∏ —Ç–µ–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON).
–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞—á–∏:
–°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π HTTP-–∑–∞–ø—Ä–æ—Å.
–ö–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ (TCP/IP), –æ–Ω–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –±–∏—Ç—ã –∏ –±–∞–π—Ç—ã –¥–ª—è —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–¥–∞—á–∏.
–í–∞–∂–Ω–æ: —Å–µ—Ä–≤–µ—Ä—É –∏ –∫–ª–∏–µ–Ω—Ç—É –Ω—É–∂–Ω–æ "—á–∏—Ç–∞—Ç—å" —ç—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É.
üöÄ HTTP/2: –ë–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —É–∂–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–∑—É –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ—Ä–µ–π–º—ã –µ—â—ë –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –æ–Ω–∏ –ø–æ–ø–∞–¥—É—Ç –≤ —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫.

–ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞—á–∏:

–°–µ—Ä–≤–µ—Ä —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –≤ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ—Ä–µ–π–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, HEADERS, DATA), –µ—â—ë –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–≠—Ç–∏ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ—Ä–µ–π–º—ã –Ω–∞–ø—Ä—è–º—É—é –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ TCP, –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ç–µ–∫—Å—Ç–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.
–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

–ú–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥.
–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ —Å–∂–∞—Ç–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (HPACK).
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω–æ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏).
ü§ñ gRPC (–Ω–∞ HTTP/2): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è
–ó–¥–µ—Å—å –±–∏–Ω–∞—Ä–∏–∑–∞—Ü–∏—è –∏–¥—ë—Ç –µ—â—ë –≥–ª—É–±–∂–µ:
–°–∞–º–∏ –¥–∞–Ω–Ω—ã–µ (–Ω–µ —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏) —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –ø–æ–º–æ—â—å—é Protobuf.
–≠—Ç–æ –¥–∞—ë—Ç –µ—â—ë –±–æ–ª—å—à—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JSON).
üéØ –ö—Ä–∞—Ç–∫–∏–π –≤—ã–≤–æ–¥:
HTTP/1.1: —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –±–∏—Ç—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–∏.
HTTP/2: –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —É–∂–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí –ø–µ—Ä–µ–¥–∞—á–∞ –≤ —Å–µ—Ç—å –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
gRPC: –¥–∞–Ω–Ω—ã–µ –±–∏–Ω–∞—Ä–∏–∑—É—é—Ç—Å—è –µ—â—ë –≥–ª—É–±–∂–µ (—á–µ—Ä–µ–∑ Protobuf) –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø–æ–≤–µ—Ä—Ö HTTP/2.
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –º–æ–≥—É –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ –≤ Wireshark –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏. üöÄ